<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="description" content="Classic Boulder Dash arcade game - Collect diamonds, avoid falling rocks, and escape! Retro 80s gaming action with modern PWA features.">
    <meta name="keywords" content="boulder dash, arcade game, retro game, puzzle game, diamond collector, pwa game">
    <meta name="author" content="Boulder Dash Team">
    <meta name="theme-color" content="#000000">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Boulder Dash">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Boulder Dash - Retro Arcade Game">
    <meta property="og:description" content="Classic Boulder Dash arcade game - Collect diamonds, avoid falling rocks, and escape!">
    <meta property="og:image" content="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><rect width='512' height='512' fill='%23000'/><text x='256' y='400' font-size='320' text-anchor='middle' fill='%2300ffff'>ğŸ’</text></svg>">
    <meta property="og:url" content="https://boulderdash.game">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Boulder Dash - Retro Arcade Game">
    <meta name="twitter:description" content="Classic Boulder Dash arcade game - Collect diamonds, avoid falling rocks, and escape!">
    
    <title>Boulder Dash - Retro Arcade Game</title>
    
    <!-- Preload critical resources -->
    <link rel="preconnect" href="https://www.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://www.gstatic.com">
    
    <link rel="stylesheet" href="./style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ’</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 192 192%22><rect width=%22192%22 height=%22192%22 fill=%22%23000%22 rx=%2248%22/><text x=%2296%22 y=%22150%22 font-size=%22120%22 text-anchor=%22middle%22 fill=%22%2300ffff%22>ğŸ’</text></svg>">
    
    <!-- Firebase SDK - Realtime Database Only -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js" defer></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js" defer></script>
</head>
<body>
    <div class="game-container">
        <div class="game-header">
            <h1>Boulder Dash</h1>
            <div class="game-info">
                <div id="score">Score: 0</div>
                <div id="diamonds">Diamonds: 0/0</div>
                <div id="time">Time: 00:00</div>
                <div id="level">Level: 1</div>
            </div>
        </div>
        <canvas id="gameCanvas"></canvas>
        <div class="game-controls">
            <div class="controls-info">
                <p>Use arrow keys or WASD to move</p>
                <button id="startButton">Start Game</button>
                <button id="restartButton" class="hidden">Restart</button>
                <button id="helpButton">How to Play</button>
            </div>
        </div>
        
        <!-- Help modal (hidden by default) -->
        <div id="helpModal" class="help-modal hidden">
            <h2 class="help-title">How to Play</h2>
            <ul class="help-list">
                <li>ğŸ® Use <strong>Arrow keys</strong> or <strong>WASD</strong> to move</li>
                <li>ğŸ’ Collect enough diamonds to open the exit</li>
                <li>ğŸª¨ Push boulders to clear paths and crush enemies</li>
                <li>âš ï¸ Avoid falling rocks or being crushed</li>
                <li>ğŸ‘¹ Stay away from enemies</li>
                <li>ğŸšª Find the exit after collecting enough diamonds</li>
            </ul>
            <button id="closeHelpButton" class="help-close">Close</button>
        </div>
    </div>
    
    <!-- Mobile Touch Controls -->
    <div id="touchControls" class="touch-controls hidden">
        <div class="dpad">
            <button class="dpad-btn dpad-up" data-direction="UP" aria-label="Move Up">â–²</button>
            <button class="dpad-btn dpad-left" data-direction="LEFT" aria-label="Move Left">â—„</button>
            <button class="dpad-btn dpad-center" id="grabButton" aria-label="Grab">GRAB</button>
            <button class="dpad-btn dpad-right" data-direction="RIGHT" aria-label="Move Right">â–º</button>
            <button class="dpad-btn dpad-down" data-direction="DOWN" aria-label="Move Down">â–¼</button>
        </div>
    </div>
    
    <script>
        // Register Service Worker for PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(registration => {
                        console.log('SW registered:', registration);
                        
                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New version available
                                    if (confirm('New version available! Reload to update?')) {
                                        newWorker.postMessage({ type: 'SKIP_WAITING' });
                                        window.location.reload();
                                    }
                                }
                            });
                        });
                    })
                    .catch(err => console.log('SW registration failed:', err));
            });
        }
        
        // Install PWA prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Show install button/banner if desired
            console.log('PWA install available');
        });
    </script>
    
    <script type="module" src="./src/game.js"></script>
</body>
</html>
